import { ExerciseInfo } from '@/types/exercise';

export const exerciseDatabase: ExerciseInfo[] = [
  // ── Chest ──
  {
    id: 'bench_press',
    name: 'Bench Press',
    category: 'chest',
    met: 6.0,
    primaryMuscles: ['chest'],
    secondaryMuscles: ['front_delts', 'triceps'],
    description: 'Barbell compound pressing movement for chest development.',
    defaultRepsPerSet: 8,
    secondsPerRep: 3,
  },
  {
    id: 'incline_bench_press',
    name: 'Incline Bench Press',
    category: 'chest',
    met: 6.0,
    primaryMuscles: ['chest', 'front_delts'],
    secondaryMuscles: ['triceps'],
    description: 'Incline press emphasizing upper chest and front delts.',
    defaultRepsPerSet: 8,
    secondsPerRep: 3,
  },
  {
    id: 'dumbbell_bench_press',
    name: 'Dumbbell Bench Press',
    category: 'chest',
    met: 6.0,
    primaryMuscles: ['chest'],
    secondaryMuscles: ['front_delts', 'triceps'],
    description: 'Dumbbell pressing for chest with greater range of motion.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
  {
    id: 'chest_flyes',
    name: 'Chest Flyes',
    category: 'chest',
    met: 3.5,
    primaryMuscles: ['chest'],
    secondaryMuscles: ['front_delts'],
    description: 'Isolation movement stretching and contracting the pectorals.',
    defaultRepsPerSet: 12,
    secondsPerRep: 3,
  },
  {
    id: 'push_ups',
    name: 'Push-Ups',
    category: 'chest',
    met: 3.8,
    primaryMuscles: ['chest'],
    secondaryMuscles: ['front_delts', 'triceps', 'abs'],
    description: 'Bodyweight pressing movement for chest and triceps.',
    defaultRepsPerSet: 15,
    secondsPerRep: 2,
  },
  {
    id: 'dips',
    name: 'Dips',
    category: 'chest',
    met: 7.5,
    primaryMuscles: ['chest', 'triceps'],
    secondaryMuscles: ['front_delts'],
    description: 'Compound bodyweight movement targeting chest and triceps.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
  {
    id: 'cable_crossover',
    name: 'Cable Crossover',
    category: 'chest',
    met: 3.5,
    primaryMuscles: ['chest'],
    secondaryMuscles: ['front_delts'],
    description: 'Cable isolation for chest with constant tension.',
    defaultRepsPerSet: 12,
    secondsPerRep: 3,
  },

  // ── Back ──
  {
    id: 'pull_ups',
    name: 'Pull-Ups',
    category: 'back',
    met: 7.5,
    primaryMuscles: ['lats', 'biceps'],
    secondaryMuscles: ['rear_delts', 'traps', 'forearms'],
    description: 'Bodyweight vertical pulling for back width.',
    defaultRepsPerSet: 8,
    secondsPerRep: 3,
  },
  {
    id: 'barbell_row',
    name: 'Barbell Row',
    category: 'back',
    met: 6.0,
    primaryMuscles: ['lats', 'traps'],
    secondaryMuscles: ['rear_delts', 'biceps', 'lower_back'],
    description: 'Compound horizontal pulling for back thickness.',
    defaultRepsPerSet: 8,
    secondsPerRep: 3,
  },
  {
    id: 'dumbbell_row',
    name: 'Dumbbell Row',
    category: 'back',
    met: 6.0,
    primaryMuscles: ['lats'],
    secondaryMuscles: ['rear_delts', 'biceps', 'traps'],
    description: 'Unilateral rowing for back development.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
  {
    id: 'lat_pulldown',
    name: 'Lat Pulldown',
    category: 'back',
    met: 5.0,
    primaryMuscles: ['lats'],
    secondaryMuscles: ['biceps', 'rear_delts'],
    description: 'Cable vertical pulling targeting the lats.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
  {
    id: 'seated_cable_row',
    name: 'Seated Cable Row',
    category: 'back',
    met: 5.0,
    primaryMuscles: ['lats', 'traps'],
    secondaryMuscles: ['biceps', 'rear_delts'],
    description: 'Cable horizontal rowing for mid-back.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
  {
    id: 'deadlift',
    name: 'Deadlift',
    category: 'back',
    met: 6.0,
    primaryMuscles: ['lower_back', 'glutes', 'hamstrings'],
    secondaryMuscles: ['traps', 'lats', 'quads', 'forearms'],
    description: 'Compound hip hinge — full posterior chain.',
    defaultRepsPerSet: 5,
    secondsPerRep: 4,
  },
  {
    id: 'face_pulls',
    name: 'Face Pulls',
    category: 'back',
    met: 3.5,
    primaryMuscles: ['rear_delts', 'traps'],
    secondaryMuscles: ['biceps'],
    description: 'Cable pull targeting rear delts and upper back.',
    defaultRepsPerSet: 15,
    secondsPerRep: 2,
  },

  // ── Shoulders ──
  {
    id: 'overhead_press',
    name: 'Overhead Press',
    category: 'shoulders',
    met: 6.0,
    primaryMuscles: ['front_delts', 'side_delts'],
    secondaryMuscles: ['triceps', 'traps'],
    description: 'Barbell pressing overhead for shoulder mass.',
    defaultRepsPerSet: 8,
    secondsPerRep: 3,
  },
  {
    id: 'dumbbell_shoulder_press',
    name: 'Dumbbell Shoulder Press',
    category: 'shoulders',
    met: 6.0,
    primaryMuscles: ['front_delts', 'side_delts'],
    secondaryMuscles: ['triceps', 'traps'],
    description: 'Dumbbell overhead pressing for shoulders.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
  {
    id: 'lateral_raises',
    name: 'Lateral Raises',
    category: 'shoulders',
    met: 3.5,
    primaryMuscles: ['side_delts'],
    secondaryMuscles: ['traps'],
    description: 'Isolation for side deltoid width.',
    defaultRepsPerSet: 15,
    secondsPerRep: 2,
  },
  {
    id: 'front_raises',
    name: 'Front Raises',
    category: 'shoulders',
    met: 3.5,
    primaryMuscles: ['front_delts'],
    secondaryMuscles: ['side_delts'],
    description: 'Isolation targeting the front deltoids.',
    defaultRepsPerSet: 12,
    secondsPerRep: 2,
  },
  {
    id: 'reverse_flyes',
    name: 'Reverse Flyes',
    category: 'shoulders',
    met: 3.5,
    primaryMuscles: ['rear_delts'],
    secondaryMuscles: ['traps'],
    description: 'Isolation for rear deltoids and upper back.',
    defaultRepsPerSet: 15,
    secondsPerRep: 2,
  },
  {
    id: 'arnold_press',
    name: 'Arnold Press',
    category: 'shoulders',
    met: 6.0,
    primaryMuscles: ['front_delts', 'side_delts'],
    secondaryMuscles: ['triceps'],
    description: 'Rotational dumbbell press hitting all three delt heads.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },

  // ── Arms ──
  {
    id: 'barbell_curl',
    name: 'Barbell Curl',
    category: 'arms',
    met: 3.5,
    primaryMuscles: ['biceps'],
    secondaryMuscles: ['forearms'],
    description: 'Classic barbell curling for bicep mass.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
  {
    id: 'dumbbell_curl',
    name: 'Dumbbell Curl',
    category: 'arms',
    met: 3.5,
    primaryMuscles: ['biceps'],
    secondaryMuscles: ['forearms'],
    description: 'Dumbbell curling for bicep isolation.',
    defaultRepsPerSet: 12,
    secondsPerRep: 3,
  },
  {
    id: 'hammer_curl',
    name: 'Hammer Curl',
    category: 'arms',
    met: 3.5,
    primaryMuscles: ['biceps', 'forearms'],
    secondaryMuscles: [],
    description: 'Neutral grip curl for brachialis and forearms.',
    defaultRepsPerSet: 12,
    secondsPerRep: 3,
  },
  {
    id: 'tricep_pushdown',
    name: 'Tricep Pushdown',
    category: 'arms',
    met: 3.5,
    primaryMuscles: ['triceps'],
    secondaryMuscles: [],
    description: 'Cable pushdown isolating the triceps.',
    defaultRepsPerSet: 12,
    secondsPerRep: 2,
  },
  {
    id: 'skull_crushers',
    name: 'Skull Crushers',
    category: 'arms',
    met: 3.5,
    primaryMuscles: ['triceps'],
    secondaryMuscles: [],
    description: 'Lying tricep extension for long head development.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
  {
    id: 'overhead_tricep_extension',
    name: 'Overhead Tricep Extension',
    category: 'arms',
    met: 3.5,
    primaryMuscles: ['triceps'],
    secondaryMuscles: [],
    description: 'Overhead extension emphasizing the tricep long head.',
    defaultRepsPerSet: 12,
    secondsPerRep: 3,
  },
  {
    id: 'concentration_curl',
    name: 'Concentration Curl',
    category: 'arms',
    met: 3.5,
    primaryMuscles: ['biceps'],
    secondaryMuscles: [],
    description: 'Seated isolation curl for peak contraction.',
    defaultRepsPerSet: 12,
    secondsPerRep: 3,
  },
  {
    id: 'wrist_curls',
    name: 'Wrist Curls',
    category: 'arms',
    met: 2.8,
    primaryMuscles: ['forearms'],
    secondaryMuscles: [],
    description: 'Forearm flexor isolation for grip strength.',
    defaultRepsPerSet: 15,
    secondsPerRep: 2,
  },

  // ── Legs ──
  {
    id: 'barbell_squat',
    name: 'Barbell Squat',
    category: 'legs',
    met: 6.0,
    primaryMuscles: ['quads', 'glutes'],
    secondaryMuscles: ['hamstrings', 'lower_back', 'abs'],
    description: 'Compound lower body movement — king of exercises.',
    defaultRepsPerSet: 8,
    secondsPerRep: 3,
  },
  {
    id: 'front_squat',
    name: 'Front Squat',
    category: 'legs',
    met: 6.0,
    primaryMuscles: ['quads'],
    secondaryMuscles: ['glutes', 'abs', 'lower_back'],
    description: 'Front-loaded squat emphasizing quads and core.',
    defaultRepsPerSet: 8,
    secondsPerRep: 3,
  },
  {
    id: 'leg_press',
    name: 'Leg Press',
    category: 'legs',
    met: 5.0,
    primaryMuscles: ['quads', 'glutes'],
    secondaryMuscles: ['hamstrings'],
    description: 'Machine compound for legs with back support.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
  {
    id: 'lunges',
    name: 'Lunges',
    category: 'legs',
    met: 5.0,
    primaryMuscles: ['quads', 'glutes'],
    secondaryMuscles: ['hamstrings', 'calves'],
    description: 'Unilateral lower body movement for legs and balance.',
    defaultRepsPerSet: 12,
    secondsPerRep: 3,
  },
  {
    id: 'romanian_deadlift',
    name: 'Romanian Deadlift',
    category: 'legs',
    met: 5.0,
    primaryMuscles: ['hamstrings', 'glutes'],
    secondaryMuscles: ['lower_back'],
    description: 'Hip hinge targeting hamstrings and glutes.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
  {
    id: 'leg_extension',
    name: 'Leg Extension',
    category: 'legs',
    met: 3.5,
    primaryMuscles: ['quads'],
    secondaryMuscles: [],
    description: 'Machine isolation for the quadriceps.',
    defaultRepsPerSet: 12,
    secondsPerRep: 2,
  },
  {
    id: 'leg_curl',
    name: 'Leg Curl',
    category: 'legs',
    met: 3.5,
    primaryMuscles: ['hamstrings'],
    secondaryMuscles: ['calves'],
    description: 'Machine isolation for hamstrings.',
    defaultRepsPerSet: 12,
    secondsPerRep: 2,
  },
  {
    id: 'hip_thrust',
    name: 'Hip Thrust',
    category: 'legs',
    met: 5.0,
    primaryMuscles: ['glutes'],
    secondaryMuscles: ['hamstrings'],
    description: 'Barbell hip extension for maximal glute activation.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
  {
    id: 'calf_raises',
    name: 'Calf Raises',
    category: 'legs',
    met: 3.5,
    primaryMuscles: ['calves'],
    secondaryMuscles: [],
    description: 'Standing or seated calf raises for lower leg development.',
    defaultRepsPerSet: 15,
    secondsPerRep: 2,
  },
  {
    id: 'bulgarian_split_squat',
    name: 'Bulgarian Split Squat',
    category: 'legs',
    met: 5.0,
    primaryMuscles: ['quads', 'glutes'],
    secondaryMuscles: ['hamstrings'],
    description: 'Elevated rear-foot split squat for single-leg strength.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
  {
    id: 'hack_squat',
    name: 'Hack Squat',
    category: 'legs',
    met: 5.0,
    primaryMuscles: ['quads'],
    secondaryMuscles: ['glutes', 'hamstrings'],
    description: 'Machine squat variant emphasizing quad development.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },

  // ── Core ──
  {
    id: 'crunches',
    name: 'Crunches',
    category: 'core',
    met: 2.8,
    primaryMuscles: ['abs'],
    secondaryMuscles: [],
    description: 'Basic abdominal flexion exercise.',
    defaultRepsPerSet: 20,
    secondsPerRep: 2,
  },
  {
    id: 'plank',
    name: 'Plank',
    category: 'core',
    met: 2.8,
    primaryMuscles: ['abs'],
    secondaryMuscles: ['obliques', 'lower_back'],
    description: 'Isometric core stabilization hold.',
    defaultRepsPerSet: 1,
    secondsPerRep: 45,
  },
  {
    id: 'russian_twist',
    name: 'Russian Twist',
    category: 'core',
    met: 3.8,
    primaryMuscles: ['obliques', 'abs'],
    secondaryMuscles: [],
    description: 'Rotational core exercise for oblique development.',
    defaultRepsPerSet: 20,
    secondsPerRep: 2,
  },
  {
    id: 'hanging_leg_raise',
    name: 'Hanging Leg Raise',
    category: 'core',
    met: 3.8,
    primaryMuscles: ['abs'],
    secondaryMuscles: ['obliques', 'forearms'],
    description: 'Advanced lower ab exercise from a hanging position.',
    defaultRepsPerSet: 12,
    secondsPerRep: 3,
  },
  {
    id: 'cable_woodchop',
    name: 'Cable Woodchop',
    category: 'core',
    met: 3.8,
    primaryMuscles: ['obliques'],
    secondaryMuscles: ['abs'],
    description: 'Rotational cable movement for core power.',
    defaultRepsPerSet: 12,
    secondsPerRep: 3,
  },
  {
    id: 'ab_wheel_rollout',
    name: 'Ab Wheel Rollout',
    category: 'core',
    met: 3.8,
    primaryMuscles: ['abs'],
    secondaryMuscles: ['obliques', 'lower_back', 'lats'],
    description: 'Advanced anti-extension core exercise.',
    defaultRepsPerSet: 10,
    secondsPerRep: 4,
  },

  // ── Full Body ──
  {
    id: 'burpees',
    name: 'Burpees',
    category: 'full_body',
    met: 7.5,
    primaryMuscles: ['quads', 'chest'],
    secondaryMuscles: ['front_delts', 'triceps', 'abs', 'glutes'],
    description: 'High-intensity full body calisthenic exercise.',
    defaultRepsPerSet: 10,
    secondsPerRep: 4,
  },
  {
    id: 'clean_and_press',
    name: 'Clean & Press',
    category: 'full_body',
    met: 7.5,
    primaryMuscles: ['front_delts', 'quads', 'traps'],
    secondaryMuscles: ['glutes', 'hamstrings', 'triceps', 'lower_back'],
    description: 'Explosive compound lift from floor to overhead.',
    defaultRepsPerSet: 6,
    secondsPerRep: 5,
  },
  {
    id: 'kettlebell_swing',
    name: 'Kettlebell Swing',
    category: 'full_body',
    met: 9.8,
    primaryMuscles: ['glutes', 'hamstrings'],
    secondaryMuscles: ['lower_back', 'abs', 'front_delts'],
    description: 'Explosive hip hinge with kettlebell — high calorie burn.',
    defaultRepsPerSet: 15,
    secondsPerRep: 2,
  },
  {
    id: 'thrusters',
    name: 'Thrusters',
    category: 'full_body',
    met: 7.5,
    primaryMuscles: ['quads', 'front_delts'],
    secondaryMuscles: ['glutes', 'triceps', 'abs'],
    description: 'Front squat into overhead press — full body compound.',
    defaultRepsPerSet: 10,
    secondsPerRep: 3,
  },
];

// Default fallback for unmatched exercises
export const DEFAULT_EXERCISE: ExerciseInfo = {
  id: 'generic_weight_training',
  name: 'Weight Training (General)',
  category: 'full_body',
  met: 6.0,
  primaryMuscles: [],
  secondaryMuscles: [],
  description: 'General weight training — fallback when exercise is not in database.',
  defaultRepsPerSet: 10,
  secondsPerRep: 3,
};

/**
 * Fuzzy-match an AI-generated exercise name to the local database.
 * Strategy: exact → substring → word-overlap (≥50% threshold)
 */
export function findExerciseMatch(name: string): ExerciseInfo | null {
  const input = name.toLowerCase().trim();
  if (!input) return null;

  // 1. Exact match
  const exact = exerciseDatabase.find((e) => e.name.toLowerCase() === input);
  if (exact) return exact;

  // 2. Substring match (either direction)
  const substring = exerciseDatabase.find(
    (e) =>
      e.name.toLowerCase().includes(input) || input.includes(e.name.toLowerCase())
  );
  if (substring) return substring;

  // 3. Word-overlap scoring
  const inputWords = input.split(/[\s\-\/]+/).filter((w) => w.length > 2);
  let bestMatch: ExerciseInfo | null = null;
  let bestScore = 0;

  for (const exercise of exerciseDatabase) {
    const exWords = exercise.name
      .toLowerCase()
      .split(/[\s\-\/]+/)
      .filter((w) => w.length > 2);
    const overlap = inputWords.filter((w) =>
      exWords.some((ew) => ew.includes(w) || w.includes(ew))
    ).length;
    const score = overlap / Math.max(inputWords.length, exWords.length);
    if (score > bestScore) {
      bestScore = score;
      bestMatch = exercise;
    }
  }

  return bestScore >= 0.5 ? bestMatch : null;
}

export function getExercisesByCategory(category: ExerciseInfo['category']): ExerciseInfo[] {
  return exerciseDatabase.filter((e) => e.category === category);
}

export const categoryLabels: Record<ExerciseInfo['category'], string> = {
  chest: 'Chest',
  back: 'Back',
  shoulders: 'Shoulders',
  arms: 'Arms',
  legs: 'Legs',
  core: 'Core',
  full_body: 'Full Body',
  cardio: 'Cardio',
};
